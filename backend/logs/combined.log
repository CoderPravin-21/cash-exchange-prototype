2026-02-15 17:09:44 [error]: Error connecting to MongoDB: connect ECONNREFUSED 127.0.0.1:27017
MongooseServerSelectionError: connect ECONNREFUSED 127.0.0.1:27017
    at _handleConnectionErrors (/home/pravin/Downloads/improved-backend/node_modules/mongoose/lib/connection.js:1169:11)
    at NativeConnection.openUri (/home/pravin/Downloads/improved-backend/node_modules/mongoose/lib/connection.js:1100:11)
    at async connectDB (file:///home/pravin/Downloads/improved-backend/config/db.js:7:18)
    at async file:///home/pravin/Downloads/improved-backend/index.js:41:1
{
  "errorLabelSet": {},
  "reason": {
    "type": "Unknown",
    "servers": {
      "localhost:27017": {
        "address": "localhost:27017",
        "type": "Unknown",
        "hosts": [],
        "passives": [],
        "arbiters": [],
        "tags": {},
        "minWireVersion": 0,
        "maxWireVersion": 0,
        "roundTripTime": -1,
        "minRoundTripTime": 0,
        "lastUpdateTime": 9319572,
        "lastWriteDate": 0,
        "error": {
          "errorLabelSet": {},
          "beforeHandshake": false
        },
        "topologyVersion": null,
        "setName": null,
        "setVersion": null,
        "electionId": null,
        "logicalSessionTimeoutMinutes": null,
        "maxMessageSizeBytes": null,
        "maxWriteBatchSize": null,
        "maxBsonObjectSize": null,
        "primary": null,
        "me": null,
        "$clusterTime": null,
        "iscryptd": false
      }
    },
    "stale": false,
    "compatible": true,
    "heartbeatFrequencyMS": 10000,
    "localThresholdMS": 15,
    "setName": null,
    "maxElectionId": null,
    "maxSetVersion": null,
    "commonWireVersion": 0,
    "logicalSessionTimeoutMinutes": null
  },
  "cause": {
    "type": "Unknown",
    "servers": {
      "localhost:27017": {
        "address": "localhost:27017",
        "type": "Unknown",
        "hosts": [],
        "passives": [],
        "arbiters": [],
        "tags": {},
        "minWireVersion": 0,
        "maxWireVersion": 0,
        "roundTripTime": -1,
        "minRoundTripTime": 0,
        "lastUpdateTime": 9319572,
        "lastWriteDate": 0,
        "error": {
          "errorLabelSet": {},
          "beforeHandshake": false
        },
        "topologyVersion": null,
        "setName": null,
        "setVersion": null,
        "electionId": null,
        "logicalSessionTimeoutMinutes": null,
        "maxMessageSizeBytes": null,
        "maxWriteBatchSize": null,
        "maxBsonObjectSize": null,
        "primary": null,
        "me": null,
        "$clusterTime": null,
        "iscryptd": false
      }
    },
    "stale": false,
    "compatible": true,
    "heartbeatFrequencyMS": 10000,
    "localThresholdMS": 15,
    "setName": null,
    "maxElectionId": null,
    "maxSetVersion": null,
    "commonWireVersion": 0,
    "logicalSessionTimeoutMinutes": null
  }
}
2026-02-15 17:10:55 [error]: Error connecting to MongoDB: connect ECONNREFUSED 127.0.0.1:27017
MongooseServerSelectionError: connect ECONNREFUSED 127.0.0.1:27017
    at _handleConnectionErrors (/home/pravin/Downloads/improved-backend/node_modules/mongoose/lib/connection.js:1169:11)
    at NativeConnection.openUri (/home/pravin/Downloads/improved-backend/node_modules/mongoose/lib/connection.js:1100:11)
    at async connectDB (file:///home/pravin/Downloads/improved-backend/config/db.js:7:18)
    at async file:///home/pravin/Downloads/improved-backend/index.js:41:1
{
  "errorLabelSet": {},
  "reason": {
    "type": "Unknown",
    "servers": {
      "localhost:27017": {
        "address": "localhost:27017",
        "type": "Unknown",
        "hosts": [],
        "passives": [],
        "arbiters": [],
        "tags": {},
        "minWireVersion": 0,
        "maxWireVersion": 0,
        "roundTripTime": -1,
        "minRoundTripTime": 0,
        "lastUpdateTime": 9390410,
        "lastWriteDate": 0,
        "error": {
          "errorLabelSet": {},
          "beforeHandshake": false
        },
        "topologyVersion": null,
        "setName": null,
        "setVersion": null,
        "electionId": null,
        "logicalSessionTimeoutMinutes": null,
        "maxMessageSizeBytes": null,
        "maxWriteBatchSize": null,
        "maxBsonObjectSize": null,
        "primary": null,
        "me": null,
        "$clusterTime": null,
        "iscryptd": false
      }
    },
    "stale": false,
    "compatible": true,
    "heartbeatFrequencyMS": 10000,
    "localThresholdMS": 15,
    "setName": null,
    "maxElectionId": null,
    "maxSetVersion": null,
    "commonWireVersion": 0,
    "logicalSessionTimeoutMinutes": null
  },
  "cause": {
    "type": "Unknown",
    "servers": {
      "localhost:27017": {
        "address": "localhost:27017",
        "type": "Unknown",
        "hosts": [],
        "passives": [],
        "arbiters": [],
        "tags": {},
        "minWireVersion": 0,
        "maxWireVersion": 0,
        "roundTripTime": -1,
        "minRoundTripTime": 0,
        "lastUpdateTime": 9390410,
        "lastWriteDate": 0,
        "error": {
          "errorLabelSet": {},
          "beforeHandshake": false
        },
        "topologyVersion": null,
        "setName": null,
        "setVersion": null,
        "electionId": null,
        "logicalSessionTimeoutMinutes": null,
        "maxMessageSizeBytes": null,
        "maxWriteBatchSize": null,
        "maxBsonObjectSize": null,
        "primary": null,
        "me": null,
        "$clusterTime": null,
        "iscryptd": false
      }
    },
    "stale": false,
    "compatible": true,
    "heartbeatFrequencyMS": 10000,
    "localThresholdMS": 15,
    "setName": null,
    "maxElectionId": null,
    "maxSetVersion": null,
    "commonWireVersion": 0,
    "logicalSessionTimeoutMinutes": null
  }
}
2026-02-15 17:12:45 [error]: Error connecting to MongoDB: connect ECONNREFUSED 127.0.0.1:27017
MongooseServerSelectionError: connect ECONNREFUSED 127.0.0.1:27017
    at _handleConnectionErrors (/home/pravin/Downloads/improved-backend/node_modules/mongoose/lib/connection.js:1169:11)
    at NativeConnection.openUri (/home/pravin/Downloads/improved-backend/node_modules/mongoose/lib/connection.js:1100:11)
    at async connectDB (file:///home/pravin/Downloads/improved-backend/config/db.js:7:18)
    at async file:///home/pravin/Downloads/improved-backend/index.js:41:1
{
  "errorLabelSet": {},
  "reason": {
    "type": "Unknown",
    "servers": {
      "localhost:27017": {
        "address": "localhost:27017",
        "type": "Unknown",
        "hosts": [],
        "passives": [],
        "arbiters": [],
        "tags": {},
        "minWireVersion": 0,
        "maxWireVersion": 0,
        "roundTripTime": -1,
        "minRoundTripTime": 0,
        "lastUpdateTime": 9500155,
        "lastWriteDate": 0,
        "error": {
          "errorLabelSet": {},
          "beforeHandshake": false
        },
        "topologyVersion": null,
        "setName": null,
        "setVersion": null,
        "electionId": null,
        "logicalSessionTimeoutMinutes": null,
        "maxMessageSizeBytes": null,
        "maxWriteBatchSize": null,
        "maxBsonObjectSize": null,
        "primary": null,
        "me": null,
        "$clusterTime": null,
        "iscryptd": false
      }
    },
    "stale": false,
    "compatible": true,
    "heartbeatFrequencyMS": 10000,
    "localThresholdMS": 15,
    "setName": null,
    "maxElectionId": null,
    "maxSetVersion": null,
    "commonWireVersion": 0,
    "logicalSessionTimeoutMinutes": null
  },
  "cause": {
    "type": "Unknown",
    "servers": {
      "localhost:27017": {
        "address": "localhost:27017",
        "type": "Unknown",
        "hosts": [],
        "passives": [],
        "arbiters": [],
        "tags": {},
        "minWireVersion": 0,
        "maxWireVersion": 0,
        "roundTripTime": -1,
        "minRoundTripTime": 0,
        "lastUpdateTime": 9500155,
        "lastWriteDate": 0,
        "error": {
          "errorLabelSet": {},
          "beforeHandshake": false
        },
        "topologyVersion": null,
        "setName": null,
        "setVersion": null,
        "electionId": null,
        "logicalSessionTimeoutMinutes": null,
        "maxMessageSizeBytes": null,
        "maxWriteBatchSize": null,
        "maxBsonObjectSize": null,
        "primary": null,
        "me": null,
        "$clusterTime": null,
        "iscryptd": false
      }
    },
    "stale": false,
    "compatible": true,
    "heartbeatFrequencyMS": 10000,
    "localThresholdMS": 15,
    "setName": null,
    "maxElectionId": null,
    "maxSetVersion": null,
    "commonWireVersion": 0,
    "logicalSessionTimeoutMinutes": null
  }
}
2026-02-15 17:15:04 [error]: Error connecting to MongoDB: connect ECONNREFUSED 127.0.0.1:27017
MongooseServerSelectionError: connect ECONNREFUSED 127.0.0.1:27017
    at _handleConnectionErrors (/home/pravin/Downloads/improved-backend/node_modules/mongoose/lib/connection.js:1169:11)
    at NativeConnection.openUri (/home/pravin/Downloads/improved-backend/node_modules/mongoose/lib/connection.js:1100:11)
    at async connectDB (file:///home/pravin/Downloads/improved-backend/config/db.js:7:18)
    at async file:///home/pravin/Downloads/improved-backend/index.js:41:1
{
  "errorLabelSet": {},
  "reason": {
    "type": "Unknown",
    "servers": {
      "localhost:27017": {
        "address": "localhost:27017",
        "type": "Unknown",
        "hosts": [],
        "passives": [],
        "arbiters": [],
        "tags": {},
        "minWireVersion": 0,
        "maxWireVersion": 0,
        "roundTripTime": -1,
        "minRoundTripTime": 0,
        "lastUpdateTime": 9638779,
        "lastWriteDate": 0,
        "error": {
          "errorLabelSet": {},
          "beforeHandshake": false
        },
        "topologyVersion": null,
        "setName": null,
        "setVersion": null,
        "electionId": null,
        "logicalSessionTimeoutMinutes": null,
        "maxMessageSizeBytes": null,
        "maxWriteBatchSize": null,
        "maxBsonObjectSize": null,
        "primary": null,
        "me": null,
        "$clusterTime": null,
        "iscryptd": false
      }
    },
    "stale": false,
    "compatible": true,
    "heartbeatFrequencyMS": 10000,
    "localThresholdMS": 15,
    "setName": null,
    "maxElectionId": null,
    "maxSetVersion": null,
    "commonWireVersion": 0,
    "logicalSessionTimeoutMinutes": null
  },
  "cause": {
    "type": "Unknown",
    "servers": {
      "localhost:27017": {
        "address": "localhost:27017",
        "type": "Unknown",
        "hosts": [],
        "passives": [],
        "arbiters": [],
        "tags": {},
        "minWireVersion": 0,
        "maxWireVersion": 0,
        "roundTripTime": -1,
        "minRoundTripTime": 0,
        "lastUpdateTime": 9638779,
        "lastWriteDate": 0,
        "error": {
          "errorLabelSet": {},
          "beforeHandshake": false
        },
        "topologyVersion": null,
        "setName": null,
        "setVersion": null,
        "electionId": null,
        "logicalSessionTimeoutMinutes": null,
        "maxMessageSizeBytes": null,
        "maxWriteBatchSize": null,
        "maxBsonObjectSize": null,
        "primary": null,
        "me": null,
        "$clusterTime": null,
        "iscryptd": false
      }
    },
    "stale": false,
    "compatible": true,
    "heartbeatFrequencyMS": 10000,
    "localThresholdMS": 15,
    "setName": null,
    "maxElectionId": null,
    "maxSetVersion": null,
    "commonWireVersion": 0,
    "logicalSessionTimeoutMinutes": null
  }
}
2026-02-15 17:18:50 [info]: MongoDB Connected: ac-ghvjycu-shard-00-00.sejblrz.mongodb.net
2026-02-15 17:18:50 [info]: 游 Server running in development mode on port 5000
2026-02-15 17:18:50 [info]: 游니 Health check: http://localhost:5000/health
2026-02-15 17:18:50 [info]: 游닄 API documentation: http://localhost:5000/api
2026-02-15 17:19:21 [info]: GET /health
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-15 17:20:10 [info]: GET /health
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-15 17:20:10 [info]: GET /favicon.ico
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-15 17:20:10 [error]: Error occurred: Route not found: /favicon.ico
Error: Route not found: /favicon.ico
    at notFound (file:///home/pravin/Downloads/improved-backend/middleware/errorHandler.js:74:17)
    at Layer.handle [as handle_request] (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:328:13)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:286:9
    at router.process_params (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:346:12)
    at next (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:280:10)
    at file:///home/pravin/Downloads/improved-backend/index.js:79:5
    at Layer.handle [as handle_request] (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:328:13)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:286:9
{
  "path": "/favicon.ico",
  "method": "GET",
  "ip": "::1"
}
2026-02-15 17:30:20 [info]: MongoDB Connected: ac-ghvjycu-shard-00-00.sejblrz.mongodb.net
2026-02-19 20:34:31 [info]: MongoDB Connected: ac-ghvjycu-shard-00-00.sejblrz.mongodb.net
2026-02-19 20:34:32 [info]: 游 Server running in development mode on port 5000
2026-02-19 20:34:32 [info]: 游니 Health check: http://localhost:5000/health
2026-02-19 20:34:32 [info]: 游닄 API documentation: http://localhost:5000/api
2026-02-19 20:35:52 [info]: GET /
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 20:35:52 [error]: Error occurred: Route not found: /
Error: Route not found: /
    at notFound (file:///home/pravin/Downloads/improved-backend/middleware/errorHandler.js:74:17)
    at Layer.handle [as handle_request] (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:328:13)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:286:9
    at router.process_params (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:346:12)
    at next (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:280:10)
    at file:///home/pravin/Downloads/improved-backend/index.js:79:5
    at Layer.handle [as handle_request] (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:328:13)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:286:9
{
  "path": "/",
  "method": "GET",
  "ip": "::1"
}
2026-02-19 20:35:52 [info]: GET /favicon.ico
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 20:35:52 [error]: Error occurred: Route not found: /favicon.ico
Error: Route not found: /favicon.ico
    at notFound (file:///home/pravin/Downloads/improved-backend/middleware/errorHandler.js:74:17)
    at Layer.handle [as handle_request] (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:328:13)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:286:9
    at router.process_params (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:346:12)
    at next (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:280:10)
    at file:///home/pravin/Downloads/improved-backend/index.js:79:5
    at Layer.handle [as handle_request] (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:328:13)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:286:9
{
  "path": "/favicon.ico",
  "method": "GET",
  "ip": "::1"
}
2026-02-19 20:36:01 [info]: GET /health
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 20:38:10 [info]: POST /api/auth/register
{
  "body": {
    "name": "Alice",
    "email": "alice@example.com",
    "password": "alice123",
    "location": {
      "coordinates": [
        77.5946,
        12.9716
      ]
    }
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 20:39:52 [info]: POST /api/auth/register
{
  "body": {
    "name": "Alice Johnson",
    "email": "alice@example.com",
    "password": "Alice123",
    "location": {
      "coordinates": [
        77.5946,
        12.9716
      ]
    }
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 20:44:34 [info]: MongoDB Connected: ac-ghvjycu-shard-00-00.sejblrz.mongodb.net
2026-02-19 20:45:06 [warn]: MongoDB disconnected
2026-02-19 20:45:13 [info]: MongoDB Connected: ac-ghvjycu-shard-00-00.sejblrz.mongodb.net
2026-02-19 20:45:13 [info]: 游 Server running in development mode on port 5000
2026-02-19 20:45:13 [info]: 游니 Health check: http://localhost:5000/health
2026-02-19 20:45:13 [info]: 游닄 API documentation: http://localhost:5000/api
2026-02-19 20:45:29 [info]: POST /api/auth/register
{
  "body": {
    "name": "Alice Johnson",
    "email": "alice@example.com",
    "password": "alice123",
    "location": {
      "coordinates": [
        77.5946,
        12.9716
      ]
    }
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 20:45:29 [info]: User registered successfully
{
  "userId": "69972911a2c74df0894cf5c3",
  "email": "alice@example.com"
}
2026-02-19 20:46:39 [info]: POST /api/auth/login
{
  "body": {
    "email": "alice@example.com",
    "password": "alice123"
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 20:46:39 [info]: User logged in successfully
{
  "userId": "69972911a2c74df0894cf5c3",
  "email": "alice@example.com"
}
2026-02-19 20:48:09 [info]: POST /api/exchange
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 20:49:46 [info]: POST /api/exchange
{
  "body": {
    "amount": 1000,
    "exchangeType": "CASH_TO_ONLINE",
    "latitude": 12.9716,
    "longitude": 77.5946
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 20:49:47 [info]: Exchange request created
{
  "userId": "69972911a2c74df0894cf5c3",
  "requestId": "69972a12a2c74df0894cf5ce"
}
2026-02-19 20:50:43 [info]: POST /api/auth/register
{
  "body": {
    "name": "Bob Smith",
    "email": "bob@example.com",
    "password": "bob123",
    "location": {
      "coordinates": [
        77.595,
        12.972
      ]
    }
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 20:50:44 [info]: User registered successfully
{
  "userId": "69972a4ca2c74df0894cf5d1",
  "email": "bob@example.com"
}
2026-02-19 20:55:10 [info]: POST /api/auth/login
{
  "body": {
    "email": "bob@example.com",
    "password": "bob123"
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 20:55:11 [info]: User logged in successfully
{
  "userId": "69972a4ca2c74df0894cf5d1",
  "email": "bob@example.com"
}
2026-02-19 20:56:37 [info]: GET /api/auth/me
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 20:57:32 [info]: GET /api/auth/me
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 20:58:34 [info]: POST /api/exchange
{
  "body": {
    "amount": 1000,
    "exchangeType": "CASH_TO_ONLINE",
    "latitude": 12.9716,
    "longitude": 77.5946,
    "notes": "Meeting at Coffee Day, Indiranagar"
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 20:58:35 [error]: Error occurred: You already have an active exchange request
Error: You already have an active exchange request
    at file:///home/pravin/Downloads/improved-backend/controllers/exchangeController.js:29:11
    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
{
  "path": "/api/exchange",
  "method": "POST",
  "ip": "::1",
  "userId": "69972911a2c74df0894cf5c3"
}
2026-02-19 20:59:38 [info]: POST /api/exchange
{
  "body": {
    "amount": 1500,
    "exchangeType": "ONLINE_TO_CASH",
    "latitude": 12.972,
    "longitude": 77.595,
    "notes": "Can meet near Metro Station"
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 20:59:38 [error]: Error occurred: Insufficient wallet balance
Error: Insufficient wallet balance
    at file:///home/pravin/Downloads/improved-backend/controllers/exchangeController.js:36:11
    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
{
  "path": "/api/exchange",
  "method": "POST",
  "ip": "::1",
  "userId": "69972a4ca2c74df0894cf5d1"
}
2026-02-19 21:00:01 [info]: Expired requests updated
{
  "count": 0
}
2026-02-19 21:01:59 [info]: GET /api/exchange/nearby
{
  "body": {},
  "query": {
    "lat": "12.9720",
    "lng": "77.5950",
    "maxDistance": "5000"
  },
  "ip": "::1"
}
2026-02-19 21:24:00 [info]: POST /api/test/add-balance
{
  "body": {
    "amount": 2000
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:24:00 [error]: Error occurred: Route not found: /api/test/add-balance
Error: Route not found: /api/test/add-balance
    at notFound (file:///home/pravin/Downloads/improved-backend/middleware/errorHandler.js:74:17)
    at Layer.handle [as handle_request] (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:328:13)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:286:9
    at router.process_params (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:346:12)
    at next (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:280:10)
    at file:///home/pravin/Downloads/improved-backend/index.js:79:5
    at Layer.handle [as handle_request] (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:328:13)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:286:9
{
  "path": "/api/test/add-balance",
  "method": "POST",
  "ip": "::1"
}
2026-02-19 21:24:18 [warn]: MongoDB disconnected
2026-02-19 21:24:27 [info]: MongoDB Connected: ac-ghvjycu-shard-00-00.sejblrz.mongodb.net
2026-02-19 21:24:27 [info]: 游 Server running in development mode on port 5000
2026-02-19 21:24:27 [info]: 游니 Health check: http://localhost:5000/health
2026-02-19 21:24:27 [info]: 游닄 API documentation: http://localhost:5000/api
2026-02-19 21:24:58 [info]: POST /api/test/add-balance
{
  "body": {
    "amount": 2000
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:24:58 [error]: Auth middleware error:
{
  "error": "Invalid or expired token"
}
2026-02-19 21:25:26 [info]: DELETE /api/test/clear-all
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 21:25:26 [error]: Error occurred: Route not found: /api/test/clear-all
Error: Route not found: /api/test/clear-all
    at notFound (file:///home/pravin/Downloads/improved-backend/middleware/errorHandler.js:74:17)
    at Layer.handle [as handle_request] (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:328:13)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:286:9
    at router.process_params (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:346:12)
    at next (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:280:10)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:646:15
    at next (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:265:14)
    at router.handle (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:175:3)
    at router (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:47:12)
{
  "path": "/api/test/clear-all",
  "method": "DELETE",
  "ip": "::1"
}
2026-02-19 21:29:13 [warn]: MongoDB disconnected
2026-02-19 21:29:19 [info]: MongoDB Connected: ac-ghvjycu-shard-00-00.sejblrz.mongodb.net
2026-02-19 21:29:19 [info]: 游 Server running in development mode on port 5000
2026-02-19 21:29:19 [info]: 游니 Health check: http://localhost:5000/health
2026-02-19 21:29:19 [info]: 游닄 API documentation: http://localhost:5000/api
2026-02-19 21:29:40 [info]: DELETE /api/test/clear-all
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 21:30:55 [info]: POST /api/auth/register
{
  "body": {
    "name": "Alice Johnson",
    "email": "alice@example.com",
    "password": "alice123",
    "location": {
      "coordinates": [
        77.5946,
        12.9716
      ]
    }
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:30:56 [info]: User registered successfully
{
  "userId": "699733b864f877b687723ab9",
  "email": "alice@example.com"
}
2026-02-19 21:31:27 [info]: POST /api/auth/register
{
  "body": {
    "name": "Bob Smith",
    "email": "bob@example.com",
    "password": "bob123",
    "location": {
      "coordinates": [
        77.595,
        12.972
      ]
    }
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:31:28 [info]: User registered successfully
{
  "userId": "699733d764f877b687723abe",
  "email": "bob@example.com"
}
2026-02-19 21:36:23 [info]: POST /api/exchange
{
  "body": {
    "amount": 1000,
    "exchangeType": "CASH_TO_ONLINE",
    "latitude": 12.9716,
    "longitude": 77.5946,
    "notes": "I have cash, need UPI"
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:36:23 [info]: Exchange request created
{
  "userId": "699733b864f877b687723ab9",
  "requestId": "699734ff64f877b687723ac4"
}
2026-02-19 21:37:30 [info]: POST /api/test/add-balance
{
  "body": {
    "amount": 2000
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:38:49 [info]: POST /api/exchange
{
  "body": {
    "amount": 1500,
    "exchangeType": "ONLINE_TO_CASH",
    "latitude": 12.972,
    "longitude": 77.595
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:38:49 [info]: Exchange request created
{
  "userId": "699733d764f877b687723abe",
  "requestId": "6997359164f877b687723aca"
}
2026-02-19 21:41:37 [info]: POST /api/exchange/accept/699734ff64f877b687723ac4
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 21:41:37 [error]: Error occurred: Route not found: /api/exchange/accept/699734ff64f877b687723ac4
Error: Route not found: /api/exchange/accept/699734ff64f877b687723ac4
    at notFound (file:///home/pravin/Downloads/improved-backend/middleware/errorHandler.js:74:17)
    at Layer.handle [as handle_request] (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:328:13)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:286:9
    at router.process_params (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:346:12)
    at next (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:280:10)
    at /home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:646:15
    at next (/home/pravin/Downloads/improved-backend/node_modules/express/lib/router/index.js:265:14)
    at protect (file:///home/pravin/Downloads/improved-backend/middleware/authMiddleware.js:58:5)
    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
{
  "path": "/api/exchange/accept/699734ff64f877b687723ac4",
  "method": "POST",
  "ip": "::1",
  "userId": "699733d764f877b687723abe"
}
2026-02-19 21:44:45 [info]: POST /api/exchange/699734ff64f877b687723ac4/accept
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 21:44:47 [info]: Exchange request accepted
{
  "requestId": "699734ff64f877b687723ac4",
  "helperId": "699733d764f877b687723abe"
}
2026-02-19 21:45:08 [info]: GET /api/exchange/my-requests
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 21:46:00 [info]: GET /api/exchange/my-requests
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 21:47:48 [info]: GET /api/exchange/nearby
{
  "body": {},
  "query": {
    "lat": "12.9716",
    "lng": "77.5946",
    "maxDistance": "5000"
  },
  "ip": "::1"
}
2026-02-19 21:47:48 [error]: Auth middleware error:
{
  "error": "Invalid or expired token"
}
2026-02-19 21:50:51 [info]: DELETE /api/test/clear-all
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 21:50:51 [info]: POST /api/auth/register
{
  "body": {
    "name": "Alice Johnson",
    "email": "alice@example.com",
    "password": "alice123",
    "location": {
      "coordinates": [
        77.5946,
        12.9716
      ]
    }
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:50:52 [info]: User registered successfully
{
  "userId": "6997386364f877b687723ae1",
  "email": "alice@example.com"
}
2026-02-19 21:50:52 [info]: POST /api/auth/register
{
  "body": {
    "name": "Bob Smith",
    "email": "bob@example.com",
    "password": "bob123",
    "location": {
      "coordinates": [
        77.595,
        12.972
      ]
    }
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:50:52 [info]: User registered successfully
{
  "userId": "6997386464f877b687723ae6",
  "email": "bob@example.com"
}
2026-02-19 21:50:52 [info]: POST /api/test/add-balance
{
  "body": {
    "amount": 2000
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:50:53 [info]: POST /api/exchange
{
  "body": {
    "amount": 1000,
    "exchangeType": "CASH_TO_ONLINE",
    "latitude": 12.9716,
    "longitude": 77.5946,
    "notes": "Coffee Day"
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:50:53 [info]: Exchange request created
{
  "userId": "6997386364f877b687723ae1",
  "requestId": "6997386564f877b687723aee"
}
2026-02-19 21:50:53 [info]: POST /api/exchange
{
  "body": {
    "amount": 1500,
    "exchangeType": "ONLINE_TO_CASH",
    "latitude": 12.972,
    "longitude": 77.595
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:50:53 [info]: Exchange request created
{
  "userId": "6997386464f877b687723ae6",
  "requestId": "6997386564f877b687723af2"
}
2026-02-19 21:50:53 [info]: GET /api/exchange/nearby
{
  "body": {},
  "query": {
    "lat": "12.9720",
    "lng": "77.5950",
    "maxDistance": "5000"
  },
  "ip": "::1"
}
2026-02-19 21:50:54 [info]: GET /api/exchange/nearby
{
  "body": {},
  "query": {
    "lat": "12.9716",
    "lng": "77.5946",
    "maxDistance": "5000"
  },
  "ip": "::1"
}
2026-02-19 21:50:54 [info]: GET /api/exchange/nearby
{
  "body": {},
  "query": {
    "lat": "12.9720",
    "lng": "77.5950",
    "maxDistance": "100"
  },
  "ip": "::1"
}
2026-02-19 21:50:54 [info]: GET /api/exchange/nearby
{
  "body": {},
  "query": {
    "lat": "12.9720",
    "lng": "77.5950",
    "maxDistance": "1000"
  },
  "ip": "::1"
}
2026-02-19 21:50:55 [info]: POST /api/exchange/6997386564f877b687723aee/accept
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 21:50:55 [info]: Exchange request accepted
{
  "requestId": "6997386564f877b687723aee",
  "helperId": "6997386464f877b687723ae6"
}
2026-02-19 21:50:55 [info]: POST /api/exchange/6997386564f877b687723aee/complete
{
  "body": {
    "code": "839856"
  },
  "query": {},
  "ip": "::1"
}
2026-02-19 21:50:56 [error]: Error occurred: Insufficient wallet balance
Error: Insufficient wallet balance
    at userSchema.methods.debitWallet (file:///home/pravin/Downloads/improved-backend/models/User.js:137:11)
    at transactionSchema.statics.createTransaction (file:///home/pravin/Downloads/improved-backend/models/Transaction.js:97:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
    at async file:///home/pravin/Downloads/improved-backend/controllers/exchangeController.js:262:25
{
  "path": "/api/exchange/6997386564f877b687723aee/complete",
  "method": "POST",
  "ip": "::1",
  "userId": "6997386464f877b687723ae6"
}
2026-02-19 21:50:56 [info]: GET /api/exchange/my-requests
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-19 21:50:56 [info]: GET /api/exchange/my-requests
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-20 01:12:20 [info]: MongoDB reconnected
2026-02-20 01:12:20 [info]: MongoDB reconnected
2026-02-20 01:12:31 [warn]: MongoDB disconnected
2026-02-20 01:12:31 [info]: MongoDB reconnected
2026-02-20 01:12:37 [info]: MongoDB Connected: ac-ghvjycu-shard-00-00.sejblrz.mongodb.net
2026-02-20 01:12:37 [info]: 游 Server running in development mode on port 5000
2026-02-20 01:12:37 [info]: 游니 Health check: http://localhost:5000/health
2026-02-20 01:12:37 [info]: 游닄 API documentation: http://localhost:5000/api
2026-02-20 01:12:41 [info]: MongoDB Connected: ac-ghvjycu-shard-00-00.sejblrz.mongodb.net
2026-02-20 20:21:18 [info]: MongoDB Connected: ac-ghvjycu-shard-00-00.sejblrz.mongodb.net
2026-02-20 20:21:18 [info]: 游 Server running in development mode on port 5000
2026-02-20 20:21:18 [info]: 游니 Health check: http://localhost:5000/health
2026-02-20 20:21:18 [info]: 游닄 API documentation: http://localhost:5000/api
2026-02-20 20:22:12 [info]: DELETE /api/test/clear-all
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-20 20:22:12 [info]: POST /api/auth/register
{
  "body": {
    "name": "Alice Johnson",
    "email": "alice@example.com",
    "password": "alice123",
    "location": {
      "coordinates": [
        77.5946,
        12.9716
      ]
    }
  },
  "query": {},
  "ip": "::1"
}
2026-02-20 20:22:12 [info]: User registered successfully
{
  "userId": "6998751c5473d32850e37898",
  "email": "alice@example.com"
}
2026-02-20 20:22:12 [info]: POST /api/auth/register
{
  "body": {
    "name": "Bob Smith",
    "email": "bob@example.com",
    "password": "bob123",
    "location": {
      "coordinates": [
        77.595,
        12.972
      ]
    }
  },
  "query": {},
  "ip": "::1"
}
2026-02-20 20:22:12 [info]: User registered successfully
{
  "userId": "6998751c5473d32850e3789d",
  "email": "bob@example.com"
}
2026-02-20 20:22:12 [info]: POST /api/test/add-balance
{
  "body": {
    "amount": 2000
  },
  "query": {},
  "ip": "::1"
}
2026-02-20 20:22:13 [info]: POST /api/exchange
{
  "body": {
    "amount": 1000,
    "exchangeType": "CASH_TO_ONLINE",
    "latitude": 12.9716,
    "longitude": 77.5946,
    "notes": "Coffee Day"
  },
  "query": {},
  "ip": "::1"
}
2026-02-20 20:22:13 [info]: Exchange request created
{
  "userId": "6998751c5473d32850e37898",
  "requestId": "6998751d5473d32850e378a5"
}
2026-02-20 20:22:13 [info]: POST /api/exchange
{
  "body": {
    "amount": 1500,
    "exchangeType": "ONLINE_TO_CASH",
    "latitude": 12.972,
    "longitude": 77.595
  },
  "query": {},
  "ip": "::1"
}
2026-02-20 20:22:13 [info]: Exchange request created
{
  "userId": "6998751c5473d32850e3789d",
  "requestId": "6998751d5473d32850e378a9"
}
2026-02-20 20:22:13 [info]: GET /api/exchange/nearby
{
  "body": {},
  "query": {
    "lat": "12.9720",
    "lng": "77.5950",
    "maxDistance": "5000"
  },
  "ip": "::1"
}
2026-02-20 20:22:13 [info]: GET /api/exchange/nearby
{
  "body": {},
  "query": {
    "lat": "12.9716",
    "lng": "77.5946",
    "maxDistance": "5000"
  },
  "ip": "::1"
}
2026-02-20 20:22:13 [info]: GET /api/exchange/nearby
{
  "body": {},
  "query": {
    "lat": "12.9720",
    "lng": "77.5950",
    "maxDistance": "100"
  },
  "ip": "::1"
}
2026-02-20 20:22:13 [info]: GET /api/exchange/nearby
{
  "body": {},
  "query": {
    "lat": "12.9720",
    "lng": "77.5950",
    "maxDistance": "1000"
  },
  "ip": "::1"
}
2026-02-20 20:22:13 [info]: POST /api/exchange/6998751d5473d32850e378a5/accept
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-20 20:22:14 [info]: Exchange request accepted
{
  "requestId": "6998751d5473d32850e378a5",
  "helperId": "6998751c5473d32850e3789d"
}
2026-02-20 20:22:14 [info]: POST /api/exchange/6998751d5473d32850e378a5/complete
{
  "body": {
    "code": "781901"
  },
  "query": {},
  "ip": "::1"
}
2026-02-20 20:22:14 [error]: Error occurred: Insufficient wallet balance
Error: Insufficient wallet balance
    at userSchema.methods.debitWallet (file:///home/pravin/cash-exchange/backend/models/User.js:137:11)
    at transactionSchema.statics.createTransaction (file:///home/pravin/cash-exchange/backend/models/Transaction.js:97:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
    at async file:///home/pravin/cash-exchange/backend/controllers/exchangeController.js:262:25
{
  "path": "/api/exchange/6998751d5473d32850e378a5/complete",
  "method": "POST",
  "ip": "::1",
  "userId": "6998751c5473d32850e3789d"
}
2026-02-20 20:22:14 [info]: GET /api/exchange/my-requests
{
  "body": {},
  "query": {},
  "ip": "::1"
}
2026-02-20 20:22:14 [info]: GET /api/exchange/my-requests
{
  "body": {},
  "query": {},
  "ip": "::1"
}
